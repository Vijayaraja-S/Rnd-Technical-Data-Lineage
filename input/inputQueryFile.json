{
  "inputQueryDetails": [
    {
      "queryName": "QUERY_2",
      "query": "SELECT \n    customer_id,\n    (SELECT COUNT(*) \n     FROM orders \n     WHERE customer_id = customer_id \n       AND order_date > CURRENT_DATE - INTERVAL '30 days') AS recent_orders_count,\n    (SELECT MAX(order_total) \n     FROM orders \n     WHERE customer_id = customer_id) AS max_order_total\nFROM customers\nJOIN orders ON customer_id = customer_id\nWHERE customer_id IN (\n    SELECT customer_id \n    FROM orders \n    WHERE order_total > 500\n    UNION\n    SELECT customer_id \n    FROM orders \n    WHERE order_date > CURRENT_DATE - INTERVAL '1 year'\n    UNION ALL\n    SELECT customer_id \n    FROM orders \n    WHERE order_status = 'Pending'\n)\nUNION\nSELECT \n    supplier_id AS customer_id,\n    (SELECT COUNT(*) \n     FROM supply_orders \n     WHERE supplier_id = supplier_id \n       AND supply_order_date > CURRENT_DATE - INTERVAL '30 days') AS recent_orders_count,\n    (SELECT MAX(supply_order_total) \n     FROM supply_orders \n     WHERE supplier_id = supplier_id) AS max_order_total\nFROM suppliers\nJOIN supply_orders ON supplier_id = supplier_id\nWHERE supplier_id IN (\n    SELECT supplier_id \n    FROM supply_orders \n    WHERE supply_order_total > 1000\n    UNION ALL\n    SELECT supplier_id \n    FROM supply_orders \n    WHERE supply_order_status = 'Shipped'\n)\n"
    }
  ]
}




